<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ComPPare: ComPPare</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ComPPare<span id="projectnumber">&#160;1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">ComPPare </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> <b>Header‑only benchmarking and validation for C++20 code.</b></p>
<p>ComPPare lets you time and cross‑check any number of host‑side implementations—CPU, OpenMP, CUDA, SYCL, TBB, etc.—that share the same inputs and outputs. It is intended for developers who are porting functions into new framework or hardware, allowing for standalone development and testing.</p>
<hr  />
<h1>Purpose</h1>
<ul>
<li><b>Performance comparison</b>: Measure the total call time, an inner region‑of‑interest (ROI) that you define, and the residual overhead (setup, transfers).</li>
<li><b>Validate results</b>: Report maximum, mean and total absolute error versus a designated reference implementation and flag discrepancies.</li>
<li><b>Streamline porting</b>: Run the same data set through multiple versions of a function.</li>
</ul>
<hr  />
<h1>Key capabilities</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Capability   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Header‑only   </td><td class="markdownTableBodyNone">Copy headers, or include it, and compile with C++20 or newer.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Any host backend   </td><td class="markdownTableBodyNone">Accepts any function pointer that runs on the host.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Detailed timing   </td><td class="markdownTableBodyNone">Separates overall call time, your ROI time, and setup/transfer overhead.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Built-in error comparison   </td><td class="markdownTableBodyNone">For common data types, automatically choose the correct method and compares against reference function   </td></tr>
</table>
<h1>Getting Started</h1>
<p>See <a class="el" href="md_docs_2user__guide.html">User Guide</a> for more detailed user guide and Examples to see real life examples.</p>
<p>Contributions are welcome! Please see <a href="https://funglf.github.io/ComPPare/">Code Documentation</a> if interested in contributing to this repo.</p>
<h1>Install</h1>
<h2>1. Clone repository</h2>
<div class="fragment"><div class="line">git clone https://github.com/funglf/ComPPare.git --recursive</div>
</div><!-- fragment --> <h3>If submodules like google benchmark/ nvbench is not needed:</h3>
<div class="fragment"><div class="line">git clone https://github.com/funglf/ComPPare.git</div>
</div><!-- fragment --><h2>2. (Optional) Build Google Benchmark and nvbench</h2>
<p>See <a href="https://github.com/google/benchmark/blob/b20cea674170b2ba45da0dfaf03953cdea473d0d/README.md">Google Benchmark Instructions</a></p>
<p>See <a href="https://github.com/NVIDIA/nvbench/blob/b88a45f4170af4e907e69af22a55af67859d3b49/README.md">nvbench Intructions</a></p>
<h2>3. Include ComPPare</h2>
<p>In your C++ code, simply include the comppare header file by: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="comppare_8hpp.html">comppare/comppare.hpp</a>&gt;</span></div>
<div class="ttc" id="acomppare_8hpp_html"><div class="ttname"><a href="comppare_8hpp.html">comppare.hpp</a></div><div class="ttdoc">This file is the main include file for the ComPPare framework.</div></div>
</div><!-- fragment --><hr  />
<h1>Quick Start</h1>
<h2>1. Adopt the required function signature</h2>
<p><em>Function output must be <code>void</code></em> and consists of the input, then output types </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> impl(<span class="keyword">const</span> Inputs&amp;... in,     <span class="comment">// read‑only inputs</span></div>
<div class="line">        Outputs&amp;...      out);     <span class="comment">// outputs compared to reference</span></div>
</div><!-- fragment --><p>In order to benchmark specific regions of code, following Macros <code>HOTLOOPSTART</code>, <code>HOTLOOPEND</code> are needed: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> impl(<span class="keyword">const</span> Inputs&amp;... in,</div>
<div class="line">        Outputs&amp;...      out);</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* </span></div>
<div class="line"><span class="comment">    setup or overhead you DO NOT want to benchmark </span></div>
<div class="line"><span class="comment">    -- memory allocation, data transfer, etc.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="comppare_8hpp.html#a03adebee29527207e43a1b362d77fe65">HOTLOOPSTART</a>; <span class="comment">// Macro of start of Benchmarking Region of Interest</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ... perform core computation here ...</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="comppare_8hpp.html#a3f983d0c821f40a98683debcc90a1e97">HOTLOOPEND</a>;   <span class="comment">// Macro of end of Benchmarking Region of Interest</span></div>
<div class="line">}</div>
<div class="ttc" id="acomppare_8hpp_html_a03adebee29527207e43a1b362d77fe65"><div class="ttname"><a href="comppare_8hpp.html#a03adebee29527207e43a1b362d77fe65">HOTLOOPSTART</a></div><div class="ttdeci">#define HOTLOOPSTART</div><div class="ttdoc">Macro to mark the start of a hot loop for benchmarking. This macro defines a lambda function hotloop_...</div><div class="ttdef"><b>Definition</b> comppare.hpp:964</div></div>
<div class="ttc" id="acomppare_8hpp_html_a3f983d0c821f40a98683debcc90a1e97"><div class="ttname"><a href="comppare_8hpp.html#a3f983d0c821f40a98683debcc90a1e97">HOTLOOPEND</a></div><div class="ttdeci">#define HOTLOOPEND</div><div class="ttdef"><b>Definition</b> comppare.hpp:1003</div></div>
</div><!-- fragment --><h3>SAXPY function example signatures</h3>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> saxpy_cpu(<span class="comment">/*Input types*/</span></div>
<div class="line">               <span class="keywordtype">float</span> a,</div>
<div class="line">               <span class="keyword">const</span> std::vector&lt;float&gt; &amp;x,</div>
<div class="line">               <span class="keyword">const</span> std::vector&lt;float&gt; &amp;y_in,</div>
<div class="line">               <span class="comment">/*Output types*/</span></div>
<div class="line">               std::vector&lt;float&gt; &amp;y_out)</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Comparing with another function with the exact same signature</span></div>
<div class="line"><span class="keywordtype">void</span> saxpy_gpu(<span class="comment">/*Input types*/</span></div>
<div class="line">               <span class="keywordtype">float</span> a,</div>
<div class="line">               <span class="keyword">const</span> std::vector&lt;float&gt; &amp;x,</div>
<div class="line">               <span class="keyword">const</span> std::vector&lt;float&gt; &amp;y_in,</div>
<div class="line">               <span class="comment">/*Output types*/</span></div>
<div class="line">               std::vector&lt;float&gt; &amp;y_out)</div>
</div><!-- fragment --><h2>2. Create a comparison object</h2>
<ol type="1">
<li><b>Describe the output types</b> as template argument</li>
<li><b>Pass the input data</b> — constructs framework object with input data that will be reused for every implementation</li>
</ol>
<div class="fragment"><div class="line"><span class="keyword">auto</span> Cmp = <a class="code hl_function" href="namespacecomppare.html#adad8650973b76e6af52067ca7487f042">comppare::make_comppare</a>&lt;<span class="comment">/*Output Types*/</span>std::vector&lt;float&gt;&gt;(a, x, y); <span class="comment">// a: float, x: input vector x, y: input vector y</span></div>
<div class="ttc" id="anamespacecomppare_html_adad8650973b76e6af52067ca7487f042"><div class="ttname"><a href="namespacecomppare.html#adad8650973b76e6af52067ca7487f042">comppare::make_comppare</a></div><div class="ttdeci">auto make_comppare(Inputs &amp;&amp;...ins)</div><div class="ttdoc">Helper function to create a comppare object.</div><div class="ttdef"><b>Definition</b> comppare.hpp:953</div></div>
</div><!-- fragment --> <blockquote class="doxtable">
<p>&zwj;Note: you can use move semantics here. All inputs are perfectly forwarded. eg. <code>Cmp cmp(a, std::move(x), std::move(y));</code> </p>
</blockquote>
<h2>3. Register implementations</h2>
<div class="fragment"><div class="line">cmp.set_reference(<span class="stringliteral">&quot;saxpy reference&quot;</span>, saxpy_cpu);  <span class="comment">// setting reference</span></div>
<div class="line">cmp.add(<span class="stringliteral">&quot;saxpy gpu&quot;</span>,  saxpy_gpu);           <span class="comment">// any number of additional functions</span></div>
</div><!-- fragment --><h2>4. Run and inspect</h2>
<div class="fragment"><div class="line">cmp.run(argc, argv);</div>
</div><!-- fragment --><h3>Sample report:</h3>
<div class="fragment"><div class="line">*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=</div>
<div class="line">============ ComPPare Framework ============</div>
<div class="line">=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*</div>
<div class="line"> </div>
<div class="line">Number of implementations:             4</div>
<div class="line">Warmup iterations:                   100</div>
<div class="line">Benchmark iterations:                100</div>
<div class="line">=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*</div>
<div class="line"> </div>
<div class="line">Implementation              ROI µs/Iter            Func µs            Ovhd µs         Max|err|[0]        Mean|err|[0]       Total|err|[0]</div>
<div class="line">saxpy reference                     0.28               33.67                5.63            0.00e+00            0.00e+00            0.00e+00                                   </div>
<div class="line">saxpy gpu                          10.89           137828.11           136739.02            5.75e+06            2.85e+06            2.92e+09            &lt;-- FAIL         </div>
</div><!-- fragment --> <h2>Complete example with SAXPY</h2>
<p>(See SAXPY Full Example)</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="comppare_8hpp.html">comppare/comppare.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Serial reference</span></div>
<div class="line"><span class="keywordtype">void</span> saxpy_cpu(<span class="comment">/*Input pack*/</span></div>
<div class="line">               <span class="keywordtype">float</span> a,</div>
<div class="line">               <span class="keyword">const</span> std::vector&lt;float&gt; &amp;x,</div>
<div class="line">               <span class="keyword">const</span> std::vector&lt;float&gt; &amp;y_in,</div>
<div class="line">               <span class="comment">/*Output pack*/</span></div>
<div class="line">               std::vector&lt;float&gt; &amp;y_out)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">size_t</span> N = x.size();</div>
<div class="line">    y_out.resize(N);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="comppare_8hpp.html#a03adebee29527207e43a1b362d77fe65">HOTLOOPSTART</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; N; ++i)</div>
<div class="line">    {</div>
<div class="line">        y_out[i] = a * x[i] + y_in[i];</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="comppare_8hpp.html#a3f983d0c821f40a98683debcc90a1e97">HOTLOOPEND</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// OpenMP variant</span></div>
<div class="line"><span class="keywordtype">void</span> saxpy_gpu(<span class="comment">/* same signature */</span>){...};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">float</span> a = 1.1f;</div>
<div class="line">    std::vector&lt;float&gt; x(1000, 2.2); <span class="comment">// Vector of size 1000 filled with 2.2</span></div>
<div class="line">    std::vector&lt;float&gt; y(1000, 3.3); <span class="comment">// Vector of size 1000 filled with 3.3</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">    Create Instance of the comparison framework with input data</span></div>
<div class="line"><span class="comment">    a -- float</span></div>
<div class="line"><span class="comment">    x -- std::vector&lt;float&gt;</span></div>
<div class="line"><span class="comment">    y -- std::vector&lt;float&gt;</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">    <span class="keyword">auto</span> Cmp = <a class="code hl_function" href="namespacecomppare.html#adad8650973b76e6af52067ca7487f042">comppare::make_comppare</a>&lt;<span class="comment">/*Output Types*/</span>std::vector&lt;float&gt;&gt;(a, x, y);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set reference implementation</span></div>
<div class="line">    cmp.set_reference(<span class="stringliteral">&quot;saxpy reference&quot;</span>, <span class="comment">/*Function*/</span> saxpy_cpu);</div>
<div class="line">    <span class="comment">// Add implementations to compare</span></div>
<div class="line">    cmp.add(<span class="stringliteral">&quot;saxpy gpu&quot;</span>, <span class="comment">/*Function*/</span> saxpy_gpu);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Run the comparison with specified iterations and tolerance</span></div>
<div class="line">    cmp.run(argc, argv);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><hr  />
 </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
